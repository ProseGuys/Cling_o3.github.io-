<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>人间客</title><link>https://proseguys.github.io/</link><description>Recent content on 人间客</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Fri, 20 Sep 2024 17:02:45 +0800</lastBuildDate><atom:link href="https://proseguys.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>MYSQL基础架构</title><link>https://proseguys.github.io/blog/mysql_basic_arch/</link><pubDate>Fri, 20 Sep 2024 17:02:45 +0800</pubDate><guid>https://proseguys.github.io/blog/mysql_basic_arch/</guid><description>&lt;p>系统介绍mysql基础架构&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/mysql_basic_arch/mysql_logic_arch.jpg" alt="架构图">&lt;/p>
&lt;h2 id="连接器">&lt;strong>连接器&lt;/strong>&lt;/h2>
&lt;p>连接器功能: 跟客户端建立连接、获取权限、维持和管理连接&lt;/p>
&lt;p>&lt;strong>PS. 一个用户成功建立连接后，即使使用管理员账号对这个用户的权限做了修改，也不会影响已经存在连接的权限。修改完成后，只有再新建的连接才会使用新的权限设置。&lt;/strong>&lt;/p>
&lt;p>客户端如果太长时间没动静，连接器就会自动将它断开。这个时间是由参数 &lt;strong>wait_timeout&lt;/strong> 控制的，默认值是 8 小时。&lt;/p>
&lt;p>长连接：指连接成功后，如果客户端持续有请求，则一直使用同一个连接&lt;/p>
&lt;p>短连接：指每次执行完很少的几次查询就断开连接，下次查询再重新建立一个。&lt;/p>
&lt;p>连接过程较复杂，因此尽量使用长连接&lt;/p>
&lt;p>&lt;strong>长连接可能出现的问题&lt;/strong>：&lt;/p>
&lt;p>MySQL 在执行过程中临时使用的内存是管理在连接对象里面的。这些资源会在连接断开的时候才释放。 长连接长时间不断开导致内存占用过多，被系统杀掉（OOM), 从现象上看 Mysql异常重启&lt;/p>
&lt;p>&lt;strong>解决方案：&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>定期断开长连接。使用一段时间，或者程序里面判断执行过一个占用内存的大查询后，断开连接，之后要查询再重连。&lt;/li>
&lt;li>如果你用的是 MySQL 5.7 或更新版本，可以在每次执行一个比较大的操作后，通过执行 mysql_reset_connection 来重新初始化连接资源。这个过程不需要重连和重新做权限验证，但是会将连接恢复到刚刚创建完时的状态。&lt;/li>
&lt;/ol>
&lt;h2 id="查询缓存">&lt;strong>查询缓存&lt;/strong>&lt;/h2>
&lt;p>建立连接后，执行语句前会先查询缓存，检查相同语句是否执行过，命中缓存则直接返回，否则继续执行。查询缓存失效非常频繁，表的任何 更新都会导致缓存失效，所以一般不使用，MySQL 8.0后，不再支持查询缓存。&lt;/p>
&lt;h2 id="分析器">&lt;strong>分析器&lt;/strong>&lt;/h2>
&lt;p>功能：对sql语句进行解析&lt;/p>
&lt;ul>
&lt;li>词法分析：通过关键字将 SQL 语句解析，生成一课对应的“解析树”，识别出sql语句中的字符串分别是什么，代表什么。&lt;/li>
&lt;li>语法分析：判断sql语句是否满足Mysql语法，&lt;strong>MySQL 解析器&lt;/strong> 使用 MySQL 语法规则，验证和解析查询，比如关键字是否正确、 关键字顺序、前后匹配等。 &lt;strong>预处理器&lt;/strong> 通过 MySQL 语法规则进一步检查语法树是否正确，比如表和数据列是否存在，名字和别名是否有歧义。&lt;/li>
&lt;/ul>
&lt;h2 id="优化器">&lt;strong>优化器&lt;/strong>&lt;/h2>
&lt;p>功能：表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。制定成本最低的执行计划。&lt;/p>
&lt;h2 id="执行器">&lt;strong>执行器&lt;/strong>&lt;/h2>
&lt;p>功能：根据优化器生成的执行计划调用存储引擎接口执行，执行计划是一个数据结构，并非字节码，MySQL 只是简单的根据执行计划逐步执行指令。&lt;/p>
&lt;p>开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，如果没有，就会返回没有权限的错误，如下所示 (在工程实现上，如果命中查询缓存，会在查询缓存返回结果的时候，做权限验证。查询也会在优化器之前调用 precheck 验证权限)。&lt;/p>
&lt;p>如果有权限，就打开表继续执行, 打开表的时候，执行器就会根据表的引擎定义，去使用这个引擎提供的接口。
&lt;img src="https://proseguys.github.io/images/mysql_basic_arch/mysql_run_process.jpg" alt="整体架构图">&lt;/p></description></item><item><title>Mysql知识图谱</title><link>https://proseguys.github.io/blog/mysql_mind_map/</link><pubDate>Fri, 06 Sep 2024 14:08:25 +0800</pubDate><guid>https://proseguys.github.io/blog/mysql_mind_map/</guid><description>&lt;p>基于 &lt;a href="https://time.geekbang.org/column/intro/100020801?utm_campaign=geektime_search&amp;amp;utm_content=geektime_search&amp;amp;utm_medium=geektime_search&amp;amp;utm_source=geektime_search&amp;amp;utm_term=geektime_search">《Mysql实战四十五讲》&lt;/a>
整理知识图谱&lt;/p>
&lt;p>Mysql知识图谱, 后续更新各个知识点章节内容
&lt;img src="https://proseguys.github.io/images/mysql_mind_map/mind_map.jpg" alt="mind_map.jpg">&lt;/p></description></item><item><title>WSL 虚拟磁盘清理</title><link>https://proseguys.github.io/blog/clean_wsl_disk/</link><pubDate>Tue, 27 Aug 2024 09:18:59 +0800</pubDate><guid>https://proseguys.github.io/blog/clean_wsl_disk/</guid><description>&lt;p>为什么在WSL里删除文件后，Windows的磁盘空间却纹丝不动？
WSL 磁盘清理计划，为你的磁盘保驾护航&lt;/p>
&lt;p>你有没有遇到过这样的情况：在WSL（Windows Subsystem for Linux）中勤勤恳恳地清理了一堆文件，结果转到Windows查看磁盘空间，发现那个数字一点都没变？这到底是哪里出了问题？今天我们来揭开这个令人困惑的谜团！&lt;/p>
&lt;h2 id="1-原因分析">1. 原因分析&lt;/h2>
&lt;p>WSL2 运行在一个虚拟化的Linux文件系统之上，而这个文件系统本质上是一个存储在Windows中的虚拟硬盘文件（通常是ext4.vhdx）。当你在WSL中删除文件时，文件系统的元数据可能已经更新，但这个.vhdx文件的大小不会自动缩小。Windows并不知道你在WSL中发生了什么，它只是看着这个.vhdx文件的总大小，所以磁盘空间似乎没有变化。&lt;/p>
&lt;h2 id="2-如何释放真正的空间">2. 如何释放真正的空间&lt;/h2>
&lt;h3 id="21-找到对应的wsl服务">2.1 找到对应的WSL服务&lt;/h3>
&lt;p>我的 &lt;code>WSL2&lt;/code> 有如下的 Linux distributions：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&amp;gt;wsl -l -v
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> NAME STATE VERSION
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>* Ubuntu-22.04 Running &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>可以通过Windows的文件资源管理器搜索ext4.vhdx的位置，如下图所示：&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/clean_wsl_disk/image.png" alt="image.png">&lt;/p>
&lt;p>由于我这里磁盘空间不足主要是 &lt;code>Ubuntu-20.04&lt;/code> 删除文件后 &lt;code>ext4.vhd&lt;/code> 没有缩容引起的，所以只压缩了它的 &lt;code>ext4.vhdx&lt;/code>。&lt;/p>
&lt;p>如果出现删除 &lt;code>Docker&lt;/code> 镜像、删除 &lt;code>Docker&lt;/code> 容器后磁盘占用没有缩小，应该也可以类比操作。&lt;/p>
&lt;h3 id="22-压缩前的准备工作可选">2.2 压缩前的准备工作（可选）&lt;/h3>
&lt;p>如果你害怕在压缩虚拟磁盘时，因为异常导致的压缩失败，你可以先进行ext4.vhd的备份（当然，要是空间不够的情况下，还是算了吧）&lt;/p>
&lt;p>在 &lt;code>PowerShell&lt;/code> 中执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 关闭 WSL2 中的 linux distributions&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wsl --shutdown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 备份指定的 Linux distribution 到指定的位置&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wsl --export Ubuntu-20.04 D:&lt;span style="color:#ae81ff">\U&lt;/span>buntu-20.04.tar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="23-手动压缩虚拟磁盘">2.3 手动压缩虚拟磁盘&lt;/h3>
&lt;p>在 &lt;code>PowerShell&lt;/code> 中执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 关闭 WSL2 中的 linux distributions&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wsl --shutdown
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 运行管理计算机的驱动器的 DiskPart 命令&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>diskpart
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在新打开的 &lt;code>DiskPart&lt;/code> 命令窗口中执行：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 选择虚拟磁盘文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">select&lt;/span> vdisk file&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;D:\Ubuntu_WSL\ext4.vhdx&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 压缩文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>compact vdisk
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># 压缩完毕后卸载磁盘&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>detach vdisk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>上述操作执行完毕，&lt;code>WSL2&lt;/code> 删除文件后空出来的磁盘空间就被释放了。&lt;/p>
&lt;h2 id="文件迁移方案">文件迁移方案：&lt;/h2>
&lt;p>当我们第一次使用WSL2的时候，大概率并不知道Windows会进行什么处理和操作。听之任之得让他将虚拟磁盘丢在了C盘，直到系统快要卡死时才明白C盘已经爆满了，我们还可以通过迁移ext4.vhdx的方式，将C的虚拟磁盘丢入D盘中。&lt;/p>
&lt;h3 id="导出镜像">导出镜像：&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wsl --export &amp;lt;Image Name&amp;gt; &amp;lt;Export location file name.tar&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="导入镜像">导入镜像：&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wsl --import &amp;lt;Image Name&amp;gt; &amp;lt;Directory where you want to store the imported image&amp;gt; &amp;lt;Directory where the exported .tar file exists&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="验证">验证：&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wsl --list
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/clean_wsl_disk/image_1.png" alt="image.png">&lt;/p>
&lt;p>详情可参考以下文档：https://www.virtualizationhowto.com/2021/01/wsl2-backup-and-restore-images-using-import-and-export/&lt;/p>
&lt;h2 id="总结">&lt;strong>总结&lt;/strong>&lt;/h2>
&lt;p>在WSL中删除文件后，Windows磁盘空间未变的原因其实是由于WSL使用虚拟硬盘存储文件，而删除文件后这个虚拟硬盘并不会自动缩小。通过手动压缩虚拟硬盘，你可以有效释放被占用的磁盘空间。掌握这些小技巧，让你的系统运行更加高效流畅！&lt;/p></description></item><item><title>PDF 格式化提取调研</title><link>https://proseguys.github.io/blog/pdf_extractor_report/</link><pubDate>Thu, 15 Aug 2024 15:54:10 +0800</pubDate><guid>https://proseguys.github.io/blog/pdf_extractor_report/</guid><description>&lt;p>在整理PDF 格式化内容提取方案时，发现当前网上所提及的库要么落后于时代版本要么就是各种文字描述语焉不详。因此根据调研结果重新整理&lt;/p>
&lt;h2 id="需求">需求：&lt;/h2>
&lt;p>提取PDF文件内容，如果PDF文件中数据之间包含段落关系，需保留其段落关系。&lt;/p>
&lt;h2 id="困难点">困难点：&lt;/h2>
&lt;p>由于PDF文件可以有多种来源生成，如html文件转换、markdown文件转换、文本影印等。部分来源文件天然不存在段落关系或者文字信息不清晰等，因此本文调研优先考虑由html和markdown等层级化文件转换成的PDF文件内容提取。&lt;/p>
&lt;h2 id="实验方案">实验方案：&lt;/h2>
&lt;p>使用由markdown文件生成的PDF文件进行内容提取，对比各自提取结构和结果&lt;/p>
&lt;p>测试文件：&lt;/p>
&lt;p>&lt;a href="https://proseguys.github.io/images/pdf_extractor_report/test.pdf">test.pdf&lt;/a>&lt;/p>
&lt;h2 id="调研对象">调研对象&lt;/h2>
&lt;ul>
&lt;li>pdfplumber&lt;/li>
&lt;li>pdfminer.six&lt;/li>
&lt;li>PyMuPDF&lt;/li>
&lt;li>pypdfium2&lt;/li>
&lt;li>marker&lt;/li>
&lt;li>MinerU&lt;/li>
&lt;/ul>
&lt;h3 id="pdfplumber">pdfplumber&lt;/h3>
&lt;p>&lt;strong>文档地址：&lt;/strong> &lt;a href="https://github.com/jsvine/pdfplumber">https://github.com/jsvine/pdfplumber&lt;/a>&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> 查看PDF文件以获取有关每个文本字符、矩形和线条的详细信息。并具有表格提取和可视化调试能力，基于pdfminer.six&lt;/p>
&lt;p>&lt;strong>测试结果：&lt;/strong> 根据PDF的单页作为内容操作的基本单位，只支持获取纯文本信息，根据段落结构获取方式不成熟，以下为测试结果&lt;/p>
&lt;ul>
&lt;li>直接文字提取&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pdfplumber
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">pdf_to_markdown&lt;/span>(pdf_path: str):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 使用 pdfplumber 打开 PDF 文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> pdfplumber&lt;span style="color:#f92672">.&lt;/span>open(pdf_path) &lt;span style="color:#66d9ef">as&lt;/span> pdf:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> page &lt;span style="color:#f92672">in&lt;/span> pdf&lt;span style="color:#f92672">.&lt;/span>pages:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 提取每页的 HTML 内容, &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> context &lt;span style="color:#f92672">=&lt;/span> page&lt;span style="color:#f92672">.&lt;/span>extract_text()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(context)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_to_markdown(&lt;span style="color:#e6db74">&amp;#34;pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled.png" alt="Untitled">&lt;/p>
&lt;p>丢失文件段落结构，标题正文无法区分。&lt;/p>
&lt;ul>
&lt;li>段落结构获取(实验阶段)&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pdfplumber
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">pdf_to_markdown&lt;/span>(pdf_path: str):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 使用 pdfplumber 打开 PDF 文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> pdfplumber&lt;span style="color:#f92672">.&lt;/span>open(pdf_path) &lt;span style="color:#66d9ef">as&lt;/span> pdf:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> page &lt;span style="color:#f92672">in&lt;/span> pdf&lt;span style="color:#f92672">.&lt;/span>pages:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e"># 提取每页的 HTML 内容&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> context &lt;span style="color:#f92672">=&lt;/span> page&lt;span style="color:#f92672">.&lt;/span>extract_text(layout&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#66d9ef">True&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(context)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_to_markdown(&lt;span style="color:#e6db74">&amp;#34;pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%201.png" alt="Untitled">&lt;/p>
&lt;p>丢失标题结构，且增加对应换行符，增加后续解析难度&lt;/p>
&lt;h3 id="pdfminersix">&lt;strong>pdfminer.six&lt;/strong>&lt;/h3>
&lt;p>&lt;strong>文档地址：&lt;/strong> &lt;a href="https://pdfminersix.readthedocs.io/en/latest/">https://pdfminersix.readthedocs.io/en/latest/&lt;/a>&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> Pdfminer.6 是社区维护的原始 PDFMiner 的分支。它是一个从PDF文档中提取信息的工具。它专注于获取和分析文本数据。 Pdfminer.6 直接从 PDF 源代码中提取页面文本。它还可用于获取文本的确切位置、字体或颜色。&lt;/p>
&lt;p>&lt;strong>测试结果：&lt;/strong> 通过&lt;code>extract_text&lt;/code> 方法直接获取整页PDF的文本信息，丢失文本层级结构&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> pdfminer.high_level &lt;span style="color:#f92672">import&lt;/span> extract_text
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">def&lt;/span> &lt;span style="color:#a6e22e">pdf_to_markdown&lt;/span>(pdf_path: str):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> extract_text(pdf_path)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#34;./page.txt&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;w&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf_to_markdown(&lt;span style="color:#e6db74">&amp;#34;pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%202.png" alt="Untitled">&lt;/p>
&lt;p>丢失部分PDF文档结构，丢失标题层级&lt;/p>
&lt;h3 id="pymupdf">PyMuPDF&lt;/h3>
&lt;p>&lt;strong>文档地址：&lt;/strong> &lt;a href="https://pymupdf.readthedocs.io/en/latest/tutorial.html">https://pymupdf.readthedocs.io/en/latest/tutorial.html&lt;/a>&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> 高性能python库，用于PDF的数据提取、分析、转换和操作。&lt;/p>
&lt;p>PyMuPDF Pro还支持 office文件的支持，包括：&lt;/p>
&lt;ul>
&lt;li>DOC/DOCX 文档/文档CX&lt;/li>
&lt;li>PPT/PPTX&lt;/li>
&lt;li>XLS/XLSX&lt;/li>
&lt;li>HWP/HWPX&lt;/li>
&lt;/ul>
&lt;p>模块基础单元为Document实例，用户可以通过PyMuPDF打开文件，获取Document实例。Document包含许多属性和功能。其中包括元信息（如“作者”或“主题”）、总页数、大纲和加密信息。&lt;/p>
&lt;p>页面处理是PyMuPDF功能的核心，用户可以通过Document作为Page的迭代器，通过循环获取不同的Page。&lt;/p>
&lt;p>用户可以通过不同形式和详细程度提取页面的所有文本、图像和其他信息。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>text &lt;span style="color:#f92672">=&lt;/span> page&lt;span style="color:#f92672">.&lt;/span>get_text(opt)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>使用一下option选项获取不同的格式：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>“text”&lt;/strong> ：（默认）带有换行符的纯文本。没有格式、没有文本位置详细信息、没有图像。&lt;/li>
&lt;li>&lt;strong>“blocks”&lt;/strong> ：生成文本块（=段落）列表。&lt;/li>
&lt;li>&lt;strong>“words”&lt;/strong> ：生成单词列表（不包含空格的字符串）。&lt;/li>
&lt;li>&lt;strong>“html”&lt;/strong> ：创建页面的完整视觉版本，包括任何图像。这可以通过您的互联网浏览器显示。&lt;/li>
&lt;li>&lt;strong>“dict”&lt;/strong> / &lt;strong>“json”&lt;/strong> ：与 HTML 相同的信息级别，但以 Python 字典或 resp 形式提供。 JSON 字符串。有关其结构的详细信息，请参阅&lt;a href="https://pymupdf.readthedocs.io/en/latest/textpage.html#TextPage.extractDICT">&lt;code>TextPage.extractDICT()&lt;/code>&lt;/a> 。&lt;/li>
&lt;li>&lt;strong>“rawdict”&lt;/strong> / &lt;strong>“rawjson”&lt;/strong> ： &lt;strong>“dict”&lt;/strong> / **“json”**的超集。它还提供诸如 XML 之类的字符详细信息。有关其结构的详细信息，请参阅&lt;a href="https://pymupdf.readthedocs.io/en/latest/textpage.html#TextPage.extractRAWDICT">&lt;code>TextPage.extractRAWDICT()&lt;/code>&lt;/a> 。&lt;/li>
&lt;li>&lt;strong>“xhtml”&lt;/strong> ：文本信息级别为TEXT版本，但包含图像。也可以通过互联网浏览器显示。&lt;/li>
&lt;li>&lt;strong>“xml”&lt;/strong> ：不包含图像，但包含完整的位置和字体信息，具体到每个文本字符。使用 XML 模块进行解释。&lt;/li>
&lt;/ul>
&lt;p>PyMuPDF支持使用story类通过html源生成PDF，并用于解析。然而并不提供直接通过Stroy实例转换成Document实例的方法。story类相关文档：https://pymupdf.readthedocs.io/en/latest/recipes-stories.html#stories&lt;/p>
&lt;p>&lt;strong>测试结果：&lt;/strong> 根据PDF的单页作为内容操作的基本单位，保留文件结构，并提供文件大纲进行标题区分，可以通过大纲和文本内容区分相关结构，以下为测试结果&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>doc&lt;span style="color:#f92672">.&lt;/span>get_toc() &lt;span style="color:#75715e"># 获取Document的大纲信息&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%203.png" alt="Untitled">&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pymupdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>doc &lt;span style="color:#f92672">=&lt;/span> pymupdf&lt;span style="color:#f92672">.&lt;/span>open(&lt;span style="color:#e6db74">&amp;#34;./pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> page &lt;span style="color:#f92672">in&lt;/span> doc:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text &lt;span style="color:#f92672">=&lt;/span> page&lt;span style="color:#f92672">.&lt;/span>get_text()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">+=&lt;/span> text
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#34;./pdf_test/pymupdf.txt&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;w&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(content)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%204.png" alt="Untitled">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%205.png" alt="Untitled">&lt;/p>
&lt;h3 id="pypdfium2">pypdfium2&lt;/h3>
&lt;p>&lt;strong>文档地址：&lt;/strong> &lt;a href="https://github.com/pypdfium2-team/pypdfium2">https://github.com/pypdfium2-team/pypdfium2&lt;/a>&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> pypdfium2是与PDFium绑定的ABI 级Python 3，PDFium 是一个功能强大且经过自由许可的库，用于 PDF 渲染、检查、操作和创建。&lt;/p>
&lt;p>&lt;strong>测试结果：&lt;/strong> 与PyMuPDF类似，通过Document以及Page来实现页面文本信息的获取，也支持获取文件大纲用于判断文档标题，文本内容在获取时会丢失相关层级结构&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pypdfium2 &lt;span style="color:#66d9ef">as&lt;/span> pdfium
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf &lt;span style="color:#f92672">=&lt;/span> pdfium&lt;span style="color:#f92672">.&lt;/span>PdfDocument(&lt;span style="color:#e6db74">&amp;#34;./pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> item &lt;span style="color:#f92672">in&lt;/span> pdf&lt;span style="color:#f92672">.&lt;/span>get_toc():
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> state &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;*&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> item&lt;span style="color:#f92672">.&lt;/span>n_kids &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> item&lt;span style="color:#f92672">.&lt;/span>is_closed &lt;span style="color:#66d9ef">else&lt;/span> &lt;span style="color:#e6db74">&amp;#34;+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;?&amp;#34;&lt;/span> &lt;span style="color:#66d9ef">if&lt;/span> item&lt;span style="color:#f92672">.&lt;/span>page_index &lt;span style="color:#f92672">is&lt;/span> &lt;span style="color:#66d9ef">None&lt;/span> &lt;span style="color:#66d9ef">else&lt;/span> item&lt;span style="color:#f92672">.&lt;/span>page_index &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34; &amp;#34;&lt;/span> &lt;span style="color:#f92672">*&lt;/span> item&lt;span style="color:#f92672">.&lt;/span>level
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#34;[&lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74">] &lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74"> -&amp;gt; &lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74"> # &lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74"> &lt;/span>&lt;span style="color:#e6db74">%s&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">%&lt;/span> (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> state,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> item&lt;span style="color:#f92672">.&lt;/span>title,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> target,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> item&lt;span style="color:#f92672">.&lt;/span>view_mode,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> item&lt;span style="color:#f92672">.&lt;/span>view_pos,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(list(pdf&lt;span style="color:#f92672">.&lt;/span>get_toc()))
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%206.png" alt="Untitled">&lt;/p>
&lt;p>可以展示PDF文件的层级结构&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">import&lt;/span> pypdfium2 &lt;span style="color:#66d9ef">as&lt;/span> pdfium
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pdf &lt;span style="color:#f92672">=&lt;/span> pdfium&lt;span style="color:#f92672">.&lt;/span>PdfDocument(&lt;span style="color:#e6db74">&amp;#34;./pdf_test/test.pdf&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>content &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span> page &lt;span style="color:#f92672">in&lt;/span> pdf:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> textpage &lt;span style="color:#f92672">=&lt;/span> page&lt;span style="color:#f92672">.&lt;/span>get_textpage()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> text_all &lt;span style="color:#f92672">=&lt;/span> textpage&lt;span style="color:#f92672">.&lt;/span>get_text_range()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> print(text_all)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">+=&lt;/span> text_all
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">with&lt;/span> open(&lt;span style="color:#e6db74">&amp;#34;pdf_test/pypdfium2.txt&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;w&amp;#34;&lt;/span>) &lt;span style="color:#66d9ef">as&lt;/span> f:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> f&lt;span style="color:#f92672">.&lt;/span>write(content)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%207.png" alt="Untitled">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%208.png" alt="Untitled">&lt;/p>
&lt;p>文本提取不如PyMuPDF结构，不过依旧可以通过大纲和标题获取文件内容的层级结构。&lt;/p>
&lt;h3 id="mineru">MinerU&lt;/h3>
&lt;p>文档地址：https://github.com/VikParuchuri/marker&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> 是一款一站式、开源、高质量的数据提取工具，主要提供以下主要功能：&lt;/p>
&lt;ul>
&lt;li>Magic-PDF：是一款旨在将PDF文档转换为Markdown格式的工具，能够处理本地存储或支持S3协议的对象存储上的文件。
&lt;ul>
&lt;li>支持多种前端模型输入&lt;/li>
&lt;li>删除页眉、页脚、脚注和页码&lt;/li>
&lt;li>人类可读的布局格式&lt;/li>
&lt;li>保留原始文档的结构和格式，包括标题、段落、列表等&lt;/li>
&lt;li>Markdown 图像和表格的提取和显示&lt;/li>
&lt;li>自动检测并转换PDF乱码&lt;/li>
&lt;li>将方程转换为 LaTeX 格式&lt;/li>
&lt;li>与CPU和GPU环境的兼容性&lt;/li>
&lt;li>适用于 Windows、Linux 和 macOS 平台&lt;/li>
&lt;li>基于PDF-Extract-Kit作为PDF内容提取的工具&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Magic-Doc：是一款旨在将网页或多格式电子书转换为Markdown格式的工具。
&lt;ul>
&lt;li>网页提取：文本、图像、表格、公式信息的跨模态精准解析。&lt;/li>
&lt;li>电子书文档提取：支持epub、mobi等多种文档格式，文本、图片全面适配。&lt;/li>
&lt;li>语言类型识别：准确识别176种语言。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>本文主要记录Magic-PDF对于PDF解析效果，Magic-PDF基于PDF-Extract-Kit进行PDF内容提取，因此需要下载PaddleOcr和其自定义训练的模型。模型大小约5G左右。&lt;/p>
&lt;p>&lt;strong>测试结果：&lt;/strong> 由于Magic-PDF模块安装复杂，因此使用命令行形式进行测试&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>magic&lt;span style="color:#f92672">-&lt;/span>pdf pdf&lt;span style="color:#f92672">-&lt;/span>command &lt;span style="color:#f92672">--&lt;/span>pdf &lt;span style="color:#e6db74">&amp;#34;pdf_path/test.pdf&amp;#34;&lt;/span> &lt;span style="color:#f92672">--&lt;/span>inside_model true
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>成功执行后，会在设定好的temp-output-dir目录下生成magic-pdf文件夹。每单次执行会在此目录下生成一个文件夹内部包含解析文件&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%209.png" alt="Untitled">&lt;/p>
&lt;p>layout.pdf和spans.pdf代表源PDF文件的内部元素的布局和宽度&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%2010.png" alt="Untitled">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%2011.png" alt="Untitled">&lt;/p>
&lt;p>后缀为md的文件代表其生成的Markdown文件：&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%2012.png" alt="Untitled">&lt;/p>
&lt;p>后缀为json的文件代表各个元素的各类信息。&lt;/p>
&lt;p>通过与源文件对比，可发现存在部分元素提取异常，元素结构提取错误。标题格式误识别率较高。如下图”DNS解析流程“应该为正文内容，这里却将它识别成了标题。&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/Untitled%2013.png" alt="Untitled">&lt;/p>
&lt;h3 id="marker">marker&lt;/h3>
&lt;p>&lt;strong>文档地址：&lt;/strong> &lt;a href="https://github.com/VikParuchuri/marker">https://github.com/VikParuchuri/marker&lt;/a>&lt;/p>
&lt;p>&lt;strong>简介：&lt;/strong> 快速准确地将 PDF 转换为 Markdown。&lt;/p>
&lt;ul>
&lt;li>支持多种文档（针对书籍和科学论文进行了优化）&lt;/li>
&lt;li>支持所有语言&lt;/li>
&lt;li>清除页眉/页脚/其他杂物&lt;/li>
&lt;li>格式化表格和代码块&lt;/li>
&lt;li>提取并保存图像以及相应的 markdown&lt;/li>
&lt;li>将大多数方程转换为 latex&lt;/li>
&lt;li>可在 GPU、CPU 或 MPS 上运行&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>测试结果：通过 &lt;code>convert_single_pdf&lt;/code>方法直接获取整页PDF的文本信息，可以提取部分文档层级结构，可以提取代码、表格、公式，页眉页脚未能正确去除。&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> marker.convert &lt;span style="color:#f92672">import&lt;/span> convert_single_pdf
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">from&lt;/span> marker.models &lt;span style="color:#f92672">import&lt;/span> load_all_models
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>full_text, images, out_meta &lt;span style="color:#f92672">=&lt;/span> convert_single_pdf(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;./test2.pdf&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> load_all_models(),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> langs&lt;span style="color:#f92672">=&lt;/span>[&lt;span style="color:#e6db74">&amp;#34;Chinese&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;English&amp;#34;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> batch_multiplier&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(full_text)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(images)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>print(out_meta)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image.png" alt="image.png">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%201.png" alt="image.png">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%202.png" alt="image.png">&lt;/p>
&lt;pre>&lt;code> 部分层级结构保留
&lt;/code>&lt;/pre>
&lt;p>如下，部分文本应为正文，但却被识别成标题结构。&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%203.png" alt="image.png">&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%204.png" alt="image.png">&lt;/p>
&lt;p>实际测试中，页眉页脚未能正确去除&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%205.png" alt="image.png">&lt;/p>
&lt;pre>&lt;code> 页眉页脚未能去除
&lt;/code>&lt;/pre>
&lt;p>需要从 huggingface 导入 6 个模型，显存要求较高，测试时出现爆显存现象&lt;/p>
&lt;p>&lt;code>model_lst = [texify, layout, order, edit, detection, ocr]&lt;/code>&lt;/p>
&lt;p>&lt;img src="https://proseguys.github.io/images/pdf_extractor_report/image%206.png" alt="image.png">&lt;/p>
&lt;h2 id="小结">小结：&lt;/h2>
&lt;p>在以上模块中，如果只需要获取PDF文本信息的前提下，PyMuPDF模块的效果最好，文本提取准确，提供大纲方法获取文本标题，从而分析得出文本结构。&lt;/p>
&lt;p>若需要PDF转成Markdown格式，可以使用MinerU模块，不过当前存在模块内部依赖混乱，外部调用API不完善等问题&lt;/p></description></item></channel></rss>